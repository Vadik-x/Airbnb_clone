<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Airbnb | Holiday rentals, cabins, beach houses & more</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/index.css">
        <link rel="stylesheet" href="/css/showPage.css">
        <link href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" rel="stylesheet"/>
        <link rel="stylesheet" href="/css/ratingStar.css">
        <link
  href="https://cdn.jsdelivr.net/npm/maplibre-gl@4.0.0/dist/maplibre-gl.css"
  rel="stylesheet"
/>
    </head>
    <body>
        <%- include('../partials/header.ejs') %>

        <div class="show-main">
            <div id="listing">
                <h2><%= data.title %></h2>
                <img src="<%= data.image.url %>">
                <h2>Entire serviced <%= data.type %> in <%= data.location %></h2>
                <div class="guestFav">
                    <% if(data.guestFavorite) { %>
                        <img src="/images/left-leaf.png">
                        <h5 style="text-align: center;">Guest<br>favourite</h5>
                        <img src="/images/right-leaf.png">  
                    <% } %>
                    <div class="guestFav-text">
                        One of the most loved homes on<br>Airbnb, according to guests
                    </div>
                    <div class="guestFav-rating">
                        <p>Rating</p>
                        <p><b><%= data.rating %></b></p>
                    </div>
                </div>
                <div class="hosted-by">
                    <img src="https://www.kindpng.com/picc/m/24-248253_user-profile-default-image-png-clipart-png-download.png">
                    <div class="hosted-by-content">
                        <h6>Hosted by <%= data.owner[0].firstName %> <%= data.owner[0].lastName %></h6>
                        <p style="font-size: 0.8rem; padding-top: 0.2rem;">Superhosts</p>
                    </div>
                </div>
                <hr>
                <div class="listing-content">
                    <div class="content-text">
                        <img src="/images/trophie.png">
                        <div>
                            <h4>Top 1% of homes</h4>
                            <p>This home is one of the highest ranked based on ratings, reviews and reliability.</p>
                        </div>
                    </div>
                    <div class="content-text">
                        <i class="ri-door-open-line"></i>
                        <div>
                            <h4>Self check-in</h4>
                            <p>Check yourself in with the lockbox.</p>
                        </div>
                    </div>
                    <div class="content-text">
                        <i class="ri-hotel-bed-line"></i>
                        <div>
                            <h4>Comfy bed for better sleep</h4>
                            <p>The room-darkening blinds and extra bedding are loved by guests.</p>
                        </div>
                    </div>
                </div>
                <hr>
                <p><%= data.description %></p>
                <hr>
                <% if(currUser && currUser._id.toString() === data.owner[0]._id.toString()) { %>
                    <div class="listings-btns">
                        <button onclick="window.location.href='/home/<%= data._id %>/edit'">Edit</button>
                        <form action="/home/<%= data._id %>?_method=DELETE" method="POST">
                            <button id="form-delete-btn" type="submit">Delete</button>
                        </form>
                    </div>
                <% } %>
            </div>

            <div class="listing-price">
                <div class="listing-price-part1">
                    <i class="ri-vip-diamond-fill"></i> <b>Rare find! This place is usually booked</b>
                </div>
                <div class="listing-price-part2">
                    <div><h2>&#8377;<b><%= data.price.toLocaleString('en-IN') %></b></h2> for 2 nights</div>
                    <button>Reserve</button>
                    <p>You won't be charged yet</p>
                </div>
            </div>
        </div>

        <div class="show-review">
            <hr>
            <h1>Review</h1>
            <div class="review-box">
                <% for(review of data.reviews) { %>
                    <div>
                        <div class="user-reviewed">
                            <img src="https://www.pngarts.com/files/10/Default-Profile-Picture-PNG-Transparent-Image.png">
                            <p><b><%= review.owner.firstName %> <%= review.owner.lastName %></b></p>
                        </div>
                        <div class="user-review">
                            <p><%= review.review %></p>
                        </div>
                        <p class="starability-result" data-rating="<%= review.rating %>"></p>
                        <% if(currUser && review.owner._id.toString() === currUser._id.toString()) { %>
                            <form method="post" action="/home/<%= data._id %>/review/<%= review._id %>?_method=DELETE">
                                <button type="submit " class="review-del-btn">Delete</button>
                            </form>
                        <% } %>
                    </div>
                <% } %>
            </div>
            <hr>
            <% if(currUser) { %>
                <h2>Leave a review</h2>
                <div class="create-review">
                    <form action="/home/<%= data._id %>/review" method="post" class="needs-validation" novalidate>
                        <div>
                            <label for="review" class="form-label">review</label>
                            <textarea rows="4" name="review" type="text" id="review" class="form-control" placeholder="Enter your   review" required></textarea>
                            <div class="invalid-feedback">Please enter a review.</div>
                        </div>

                        <fieldset class="starability-heartbeat">
                            <legend>Rating</legend>
                            <input type="radio" id="no-rate" class="input-no-rate" name="rating" value="1" checked aria-label="No rating." />
                            <input type="radio" id="first-rate1" name="rating" value="1" />
                            <label for="first-rate1" title="Terrible">1 star</label>
                            <input type="radio" id="first-rate2" name="rating" value="2" />
                            <label for="first-rate2" title="Not good">2 stars</label>
                            <input type="radio" id="first-rate3" name="rating" value="3" />
                            <label for="first-rate3" title="Average">3 stars</label>
                            <input type="radio" id="first-rate4" name="rating" value="4" />
                            <label for="first-rate4" title="Very good">4 stars</label>
                            <input type="radio" id="first-rate5" name="rating" value="5" />
                            <label for="first-rate5" title="Amazing">5 stars</label>
                        </fieldset>

                        <button type="submit">Add</button>
                    </form>
                </div>
                <hr style="margin-top: 2rem;">
            <% } %>
        </div>

        <div id="show-map">
            <h3>Where youâ€™ll be</h3>
            <p id="data-location"><%= data.location %></p>
            <div id="map"></div>
        </div>

        <%- include('../partials/footer.ejs') %>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <script src="/js/createform.js"></script>
        <script src="/js/flashMessage.js"></script>
        <script>
            window.MAPTILER_KEY = "<%= mapApiKey %>";
        </script>
        <script src="https://cdn.jsdelivr.net/npm/maplibre-gl@4.0.0/dist/maplibre-gl.js"></script>
        <script src="/js/show-map.js"></script>
    </body>
</html>